---
title: "Shiny Dashboard"
output: html_document
runtime: shiny
theme: journal
---

```{r setup, echo=FALSE}
library(flexdashboard)
library(shiny)
library(readr)
library(janitor)
library(dplyr)
library(ggplot2)
library(gt)
library(tidyr)
library(shinydashboard)
```

```{r echo=FALSE, warning=FALSE, message=FALSE}
dataset_2024 <- read_csv("data/2024_data.csv") |>
                clean_names() |>
                select(-tidal_popularity)|>
  mutate(
    track = iconv(track, from = "UTF-8", to = "ASCII//TRANSLIT"),
    artist = iconv(artist, from = "UTF-8", to = "ASCII//TRANSLIT")
  ) |> 
  filter(artist!= "xSyborg")
```

```{r echo=FALSE, warning=FALSE, message=FALSE}
ui <- dashboardPage(
  dashboardHeader(title = "2023/2024 Data Visualizations"),
  
  # Sidebar with menu items
  dashboardSidebar(
    sidebarMenu(
      menuItem("2023", tabName = "2023", icon = icon("dashboard")), 
      menuItem("2024", tabName = "2024", icon = icon("bar-chart")),   
      menuItem("Comparing Years", tabName = "Comparing_Years", icon = icon("cogs"))
    )
  ),
  
  # Body with tab content
  dashboardBody(
    tabItems(
      tabItem(tabName = "2023",  
              h2("Content for 2023"),
              p("This is the content for the 2023 tab."),
              fluidRow(box(plotOutput("plot2023"))
              
      )),
      
      tabItem(tabName = "2024", 
              h2("Content for 2024"),
              p("This is the content for the 2024 tab.")
      ),
      
      tabItem(tabName = "Comparing_Years", 
              h2("Content for Comparing Years"),
              p("This is the content for the Comparing Years tab.")
      )
    )
    )
  )


# Define server logic (empty for now)
server <- function(input, output) {
  # Server-side logic goes here (if any)
     # For 2023 Tab
  output$plot2023 <- renderPlot({explicit_song2 =
  dataset_2024 |>
  mutate(explicit_track = ifelse(explicit_track == 1, "Explicit", "Non-Explicit"))
 
ggplot(explicit_song2, aes(x = explicit_track, y = spotify_popularity, fill = explicit_track)) +
  geom_boxplot() +
  labs(
    title = "Distribution of Popularity for Explicit and Non-Explicit Songs",
    x = "Track Type",
    y = "Popularity"
  ) +
  scale_fill_manual(values = c("Explicit" = "coral", "Non-Explicit" = "skyblue")) +
  theme_minimal()

  })
  
  
  # For 2024 Tab
  output$plot2024 <- renderPlot({
    # Generate random data (just an example)
    histdata <- rnorm(100)
    # Subset data based on input$slider2024
    data <- histdata[seq_len(input$slider2024)]
    # Create histogram
    hist(data, main = "Histogram for 2024", xlab = "Values", col = "lightgreen")
  })
  
  # For Comparing Years Tab
  output$plotComparing <- renderPlot({
    # Generate random data (just an example)
    histdata <- rnorm(100)
    # Subset data based on input$sliderComparing
    data <- histdata[seq_len(input$sliderComparing)]
    # Create histogram
    hist(data, main = "Comparing Years Histogram", xlab = "Values", col = "lightcoral")
  })
}

# Run the application
shinyApp(ui, server)
```

Column {.sidebar}
-----------------------------------------------------------------------

```{r}

```

Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r}
explicit_song2 =
  dataset_2024 |>
  mutate(explicit_track = ifelse(explicit_track == 1, "Explicit", "Non-Explicit"))
 
ggplot(explicit_song2, aes(x = explicit_track, y = spotify_popularity, fill = explicit_track)) +
  geom_boxplot() +
  labs(
    title = "Distribution of Popularity for Explicit and Non-Explicit Songs",
    x = "Track Type",
    y = "Popularity"
  ) +
  scale_fill_manual(values = c("Explicit" = "coral", "Non-Explicit" = "skyblue")) +
  theme_minimal()

```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}

```

### Chart C

```{r}

```

